adf.test(X_t, alternative = "stationary", k = 1)
adf.test(X_t)
source('~/Projects/kayaman/tsa/L1E3b.R')
source('~/Projects/kayaman/tsa/L1E3b.R')
source('~/Projects/kayaman/tsa/prp.R')
source('~/Projects/kayaman/tsa/L1E3c.R')
source('~/Projects/kayaman/tsa/L1E3c.R')
adf.test(moving_average_process)
source('~/Projects/kayaman/tsa/L1E3c.R')
install.packages("gdata")
library(gdata)
milk <- read.xls("Leite.xlsx", sheet = 1)
getwd()
milk <- read.xls("/Users/kayaman/Projects/tsa/Leite.xlsx", sheet = 1)
milk <- read.xls("/Users/kayaman/Projects/kayaman/tsa/Leite.xlsx", sheet = 1)
milk <- read.xls("/Users/kayaman/Projects/kayaman/tsa/Leite.xlsx", sheet = 1, header = TRUE)
milk <- read.xls("/Users/kayaman/Projects/kayaman/tsa/Leite.xlsx", sheet = 3, header = TRUE)
type(milk)
class(milk)
milk_train <- milk[["Ano" < 2018]]
milk_train <- milk["Ano" < 2018]
View(milk_train)
milk_train <- milk["Ano" < 2018,]
help("subset")
milk_train <- subset(milk, Ano < 2018)
milk_validation <- subset(milk, Ano == 2018)
source('~/Projects/kayaman/tsa/milk.R')
plot(milk_df)
help(plot)
View(milk)
milk_ts <- ts(milk_df)
plot(milk_ts)
View(milk_ts)
help(ts)
plot(milk_ts["Ano"], milk_ts["LeiteIndSP"])
plot(milk_df["Ano"], milk_df["LeiteIndSP"])
help(ts)
library(zoo)
install.packages("zoo")
install.packages("zoo")
year_qtr <- as.yearqtr(milk_df["Trimestre"])
library(zoo)
year_qtr <- as.yearqtr(milk_df["Trimestre"])
year_qtr <- as.yearqtr(as.numeric(milk_df["Trimestre"]))
year_qtr <- as.yearqtr(milk_df["Trimestre"],  format = "%Y Q%q")
year_qtr <- as.yearqtr(milk_df, format = "%Y Q%q")
tt <- with(milk_df, ts(cbind(x3, cat), start = c(year[1], qtr[1]), freq = 4))
source('~/Projects/kayaman/tsa/milk.R')
source('~/Projects/kayaman/tsa/sarima.r')
install.packages("forecast")
#ler dados de usu?rios
dados=read.delim2("clipboard",header=T,sep="\t", dec=".")
library(forecast)
ukdeaths.fit <- Arima(UKDriverDeaths,c(1,0,1),c(0,1,1),xreg=Seatbelts[,"law"])
ukdeaths.errors <- arima.errors(ukdeaths.fit)
par(mfrow=c(2,1))
plot(UKDriverDeaths)
plot(ukdeaths.errors)
_quarters <- as.character(milk_df$Ano)
_quarters <- c(as.character(milk_df$Ano))
library(gdata)
library(zoo)
milk_df <- read.xls("/Users/kayaman/Projects/kayaman/tsa/Leite.xlsx", sheet = 3, header = TRUE)
_quarters <- c(as.character(milk_df$Ano))
milk_qtr <- c(as.character(milk_df$Ano))
milk_qtr <- as.character(milk_df$Ano)
library(gdata)
library(zoo)
milk_df <- read.xls("/Users/kayaman/Projects/kayaman/tsa/Leite.xlsx", sheet = 3, header = TRUE)
milk_qtr <- as.character(milk_df$Ano)
milk_qtr <- paste(as.character(milk_df$Ano, as.character(milk_df$Trimestre, sep = " ")
milk_df <- read.xls("/Users/kayaman/Projects/kayaman/tsa/Leite.xlsx", sheet = 3, header = TRUE)
milk_qtr <- paste(as.character(milk_df$Ano, as.character(milk_df$Trimestre, sep = " ")
milk_qtr <- paste(as.character(milk_df$Ano . as.character(milk_df$Trimestre, sep = " ")
milk_qtr <- paste(as.character(milk_df$Ano, as.character(milk_df$Trimestre), sep = " ")
milk_qtr <- paste(as.character(milk_df$Ano), as.character(milk_df$Trimestre), sep = " ")
milk_df <- read.xls("/Users/kayaman/Projects/kayaman/tsa/Leite.xlsx", sheet = 3, header = TRUE)
milk_qtr <- paste(as.character(milk_df$Ano), as.character(milk_df$Trimestre), sep = " ")
help(t)
milk_qtr <- c(paste(as.character(milk_df$Ano), as.character(milk_df$Trimestre), sep = " "))
class(milk_qtr)
milk_df["Quarter"] <- lapply(milk_df, function(milk_df) paste(as.character(milk_df$Ano), as.character(milk_df$Trimestre), sep = " "))
milk_df["Quarter"] <- lapply(milk_df, function(milk_df) paste(as.character(milk_df["Ano"]), as.character(milk_df$Trimestre), sep = " "))
milk_df["Quarter"] <- lapply(milk_df, function(milk_df) paste(as.character(milk_df["Ano"]), as.character(milk_df["Trimestre"]), sep = " "))
View(milk_df)
lapply(milk_df, function(milk_df) paste(as.character(milk_df["Ano"]), as.character(milk_df["Trimestre"]), sep = " "))
milk_df["Quarter"] <- apply(milk_df, function(milk_df) paste(as.character(milk_df["Ano"]), as.character(milk_df["Trimestre"]), sep = " "))
milk_df["Quarter"] <- apply(milk_df, MARGIN = 1, FUN = function(milk_df) paste(as.character(milk_df["Ano"]), as.character(milk_df["Trimestre"]), sep = " "))
View(milk_df)
milk_df["Date"] <- apply(milk_df, MARGIN = 1, FUN = function(milk_df) as.yearqtr(milk_df["Quarter"]))
View(milk_df)
source('~/Projects/kayaman/tsa/milk.R')
View(milk_validation)
library(gdata)
library(zoo)
milk_df <- read.xls("/Users/kayaman/Projects/kayaman/tsa/Leite.xlsx", sheet = 3, header = TRUE)
milk_df["Quarter"] <- apply(milk_df, MARGIN = 1, FUN = function(milk_df) paste(as.character(milk_df["Ano"]), as.character(milk_df["Trimestre"]), sep = " "))
milk_qtr <- c(paste(as.character(milk_df$Ano), paste("Q", as.character(milk_df$Trimetre)), sep = " "))
milk_df["Quarter"] <- apply(milk_df, MARGIN = 1, FUN = function(milk_df) paste(as.character(milk_df["Ano"]), paste("Q", as.character(milk_df$Trimetre)), sep = " "))
milk_df["Quarter"] <- apply(milk_df, MARGIN = 1, FUN = function(milk_df) paste(as.character(milk_df["Ano"]), paste("Q", as.character(milk_df["Trimestre")), sep = " ")
milk_df["Quarter"] <- apply(milk_df, MARGIN = 1, FUN = function(milk_df) paste(as.character(milk_df["Ano"]), paste("Q", as.character(milk_df["Trimestre")), sep = " "))
source('~/Projects/kayaman/tsa/milk.R')
source('~/Projects/kayaman/tsa/milk.R')
source('~/Projects/kayaman/tsa/milk.R')
milk_df["Quarter"] <- apply(milk_df, MARGIN = 1, FUN = function(milk_df) paste(as.character(milk_df["Ano"]), paste("Q", as.character(milk_df["Trimestre"])), sep = " "))
source('~/Projects/kayaman/tsa/milk.R')
source('~/Projects/kayaman/tsa/milk.R')
ts.plot(milk_df["Date"], milk_df["LeiteIndSP"])
milk_ts <- ts(milk_qtr)
plot(milk_ts)
df <- data.frame(milk_df$Date, milk_df$LeiteIndSP)
source('~/Projects/kayaman/tsa/milk.R')
source('~/Projects/kayaman/tsa/milk.R')
source('~/Projects/kayaman/tsa/milk.R')
milk <- ts(df)
ts.plot(milk)
ts.plot(milk, ylim = 80)
hrlp(ts.plot)
help(ts.plot)
plot.ts(milk)
help(ts.plot)
require(graphics)
library(gdata)
library(zoo)
require(graphics)
milk_df <- read.xls("/Users/kayaman/Projects/kayaman/tsa/Leite.xlsx", sheet = 3, header = TRUE)
milk_df["Date"] <- apply(milk_df, MARGIN = 1, FUN = function(milk_df) paste(as.character(milk_df["Ano"]), paste("Q", as.character(milk_df["Trimestre"]), sep = ""), sep = " "))
milk_train <- subset(milk_df, Ano < 2018)
milk_validation <- subset(milk_df, Ano == 2018)
milk_train_qtr <- c(paste(as.character(milk_train$Ano), paste("Q", as.character(milk_train$Trimetre)), sep = " "))
milk_validation_qtr <- c(paste(as.character(milk_validation$Ano), paste("Q", as.character(milk_validation$Trimetre)), sep = " "))
df <- data.frame(milk_train_qtr["Date"], milk_train_qtr["LeiteIndSP"])
source('~/Projects/kayaman/tsa/milk.R')
source('~/Projects/kayaman/tsa/milk.R')
View(milk)
View(milk_train)
df <- data.frame(as.yearqtr(milk_train["Date"]), milk_train["LeiteIndSP"])
milk_df["Date"] <- apply(milk_df, MARGIN = 1, FUN = function(milk_df) as.yearqtr(paste(as.character(milk_df["Ano"]), paste("Q", as.character(milk_df["Trimestre"]), sep = ""), sep = " "))
milk_train <- subset(milk_df, Ano < 2018)
kayaman
library(zoo)
require(graphics)
milk_df <- read.xls("/Users/kayaman/Projects/kayaman/tsa/Leite.xlsx", sheet = 3, header = TRUE)
milk_df["Date"] <- apply(milk_df, MARGIN = 1, FUN = function(milk_df) as.yearqtr(paste(as.character(milk_df["Ano"]), paste("Q", as.character(milk_df["Trimestre"]), sep = ""), sep = " "))
milk_train <- subset(milk_df, Ano < 2018)
milk_df["Date"] <- apply(milk_df, MARGIN = 1, FUN = function(milk_df) as.yearqtr(paste(as.character(milk_df["Ano"]), paste("Q", as.character(milk_df["Trimestre"]), sep = ""), sep = " ")))
milk_train <- subset(milk_df, Ano < 2018)
milk_df["Date"] <- apply(milk_df, MARGIN = 1, FUN = function(milk_df) as.yearqtr(paste(as.character(milk_df["Ano"]), paste("Q", as.character(milk_df["Trimestre"]), sep = ""), sep = " ")))
View(milk_df)
milk_train <- subset(milk_df, Ano < 2018)
milk_validation <- subset(milk_df, Ano == 2018)
df <- data.frame(as.yearqtr(milk_train["Date"]), milk_train["LeiteIndSP"])
df <- data.frame(milk_train["Date"], milk_train["LeiteIndSP"])
milk <- ts(df)
plot.ts(milk)
milk <- ts(df$Date, df$LeiteIndSP)
milk <- ts(df$Date ~ df$LeiteIndSP)
milk <- ts(x = df$Date, y = df$LeiteIndSP)
library("ggplot2")
milk_df["Date"] <- apply(milk_df, MARGIN = 1, FUN = function(milk_df) as.yearqtr(paste(as.character(milk_df["Ano"]), paste("Q", as.character(milk_df["Trimestre"]), sep = ""), sep = " "), format = "%Y Q%q"))
milk_df["Date"] <- apply(milk_df, MARGIN = 1, FUN = function(milk_df) paste(as.character(milk_df["Ano"]), paste("Q", as.character(milk_df["Trimestre"]), sep = ""), sep = " "))
df <- data.frame(as.yearqtr(milk_train["Date"], format = "%Y Q%q"), milk_train["LeiteIndSP"])
z <- zoo(milk_train["LeiteIndSP"], as.yearqtr(milk_train["Date"], format = "%Y Q%q"))
ibrary("ggplot2")
require(graphics)
ibrary(ggplot2)
milk_df <- read.xls("/Users/kayaman/Projects/kayaman/tsa/Leite.xlsx", sheet = 3, header = TRUE)
library(ggplot2)
milk_df <- read.xls("/Users/kayaman/Projects/kayaman/tsa/Leite.xlsx", sheet = 3, header = TRUE)
milk_df["Date"] <- apply(milk_df, MARGIN = 1, FUN = function(milk_df) paste(as.character(milk_df["Ano"]), paste("Q", as.character(milk_df["Trimestre"]), sep = ""), sep = " "))
milk_train <- subset(milk_df, Ano < 2018)
milk_validation <- subset(milk_df, Ano == 2018)
z <- zoo(milk_train["LeiteIndSP"],as.yearqtr(milk_train["Date"], format = "%Y Q%q"))
milk <- ts(x = df$Date, y = df$LeiteIndSP)
help("as.yearqtr")
z <- zoo(milk_train["LeiteIndSP"], as.yearqtr.character(milk_train["Date"], format = "%Y Q%q"))
milk_df["Date"] <- apply(milk_df, MARGIN = 1, FUN = function(milk_df) as.yearqtr(paste(as.character(milk_df["Ano"]), paste("Q", as.character(milk_df["Trimestre"]), sep = ""), sep = " ")))
View(milk_validation)
source('~/Projects/kayaman/tsa/milk.R')
source('~/Projects/kayaman/tsa/milk.R')
source('~/Projects/kayaman/tsa/milk.R')
source('~/Projects/kayaman/tsa/milk.R')
source('~/Projects/kayaman/tsa/milk.R')
source('~/Projects/kayaman/tsa/milk.R')
source('~/Projects/kayaman/tsa/milk.R')
source('~/Projects/kayaman/tsa/milk.R')
source('~/Projects/kayaman/tsa/milk.R')
source('~/Projects/kayaman/tsa/milk.R')
source('~/Projects/kayaman/tsa/milk.R')
source('~/Projects/kayaman/tsa/milk.R')
source('~/Projects/kayaman/tsa/example_zoo.R')
source('~/Projects/kayaman/tsa/example_zoo.R')
d <- data.frame(sin = sin(1:8), cos = cos(1:8))
d$time <- c("Q1 1961", "Q2 1961", "Q3 1961", "Q4 1961", "Q1 1962",
"Q2 1962", "Q3 1962", "Q4 1962")
## convert to zoo series
library("zoo")
z <- zoo(as.matrix(d[, 1:2]), as.yearqtr(d$time, "Q%q %Y"))
## ggplot2 display
library("ggplot2")
autoplot(z)
## with nicer axis scaling
autoplot(z) + scale_x_yearqtr()
## some variations
autoplot(z, facets = Series ~ .) + scale_x_yearqtr() + geom_point()
autoplot(z, facets = NULL) + scale_x_yearqtr() + geom_point()
source('~/Projects/kayaman/tsa/example_zoo.R')
source('~/Projects/kayaman/tsa/milk.R')
source('~/Projects/kayaman/tsa/milk.R')
source('~/Projects/kayaman/tsa/milk.R')
z <- zoo(as.matrix(milk_df[,3]), as.yearqtr(milk_df["Date"]))
z <- zoo(as.matrix(milk_df["LeiteIndSP"]), as.yearqtr(milk_df["Date"]))
z <- zoo(as.matrix(milk_df[,"LeiteIndSP"]), as.yearqtr(milk_df["Date"]))
z <- zoo(as.matrix(milk_df$LeiteIndSP", as.yearqtr(milk_df$Date))
z <- zoo(as.matrix(milk_df$LeiteIndSP, as.yearqtr(milk_df$Date))
source('~/Projects/kayaman/tsa/milk.R')
source('~/Projects/kayaman/tsa/milk.R')
source('~/Projects/kayaman/tsa/milk.R')
source('~/Projects/kayaman/tsa/milk.R')
autoplot(z)
## with nicer axis scaling
autoplot(z) + scale_x_yearqtr()
## some variations
autoplot(z, facets = Series ~ .) + scale_x_yearqtr() + geom_point()
autoplot(z, facets = NULL) + scale_x_yearqtr() + geom_point()
source('~/Projects/kayaman/tsa/milk.R')
plot(z)
source('~/Projects/kayaman/tsa/example_zoo.R')
ggplot(z)
zoo.plot(z)
source('~/Projects/kayaman/tsa/example_zoo.R')
source('~/Projects/kayaman/tsa/milk.R')
library(gdata)
library(zoo)
milk_df <- read.xls("/Users/kayaman/Projects/kayaman/tsa/Leite.xlsx", sheet = 3, header = TRUE)
milk_df["Quarter"] <- apply(milk_df, MARGIN = 1, FUN = function(milk_df) paste(as.character(milk_df["Ano"]), paste("Q", as.character(milk_df["Trimestre"]), sep = ""), sep = " "))
library(gdata)
library(zoo)
milk_df <- read.xls("/Users/kayaman/Projects/kayaman/tsa/Leite.xlsx", sheet = 3, header = TRUE)
milk_df["Quarter"] <- apply(milk_df, MARGIN = 1, FUN = function(milk_df) paste(as.character(milk_df["Ano"]), paste("Q", as.character(milk_df["Trimestre"]), sep = ""), sep = " "))
milk_train <- subset(milk_df, Ano < 2018)
milk_validation <- subset(milk_df, Ano == 2018)
z <- zoo(as.matrix(milk_df$LeiteIndSP, as.yearqtr(milk_df$Date)))
## ggplot2 display
library("ggplot2")
autoplot(z)
## with nicer axis scaling
autoplot(z) + scale_x_yearqtr()
## some variations
autoplot(z, facets = Series ~ .) + scale_x_yearqtr() + geom_point()
autoplot(z, facets = NULL) + scale_x_yearqtr() + geom_point()
plot(z)
source('~/Projects/kayaman/tsa/milk.R')
source('~/Projects/kayaman/tsa/milk.R')
library(gdata)
library(zoo)
milk_df <- read.xls("/Users/kayaman/Projects/kayaman/tsa/Leite.xlsx", sheet = 3, header = TRUE)
milk_df["Quarter"] <- apply(milk_df, MARGIN = 1, FUN = function(milk_df) paste(as.character(milk_df["Ano"]), paste("Q", as.character(milk_df["Trimestre"]), sep = ""), sep = " "))
milk_train <- subset(milk_df, Ano < 2018)
milk_validation <- subset(milk_df, Ano == 2018)
z <- zoo(as.matrix(milk_df$LeiteIndSP, as.yearqtr(milk_df$Date, "%Y Q%q")))
## ggplot2 display
library("ggplot2")
autoplot(z)
## with nicer axis scaling
autoplot(z) + scale_x_yearqtr()
## some variations
autoplot(z, facets = Series ~ .) + scale_x_yearqtr() + geom_point()
autoplot(z, facets = NULL) + scale_x_yearqtr() + geom_point()
plot(z)
source('~/Projects/kayaman/tsa/milk.R')
d <- data.frame(sin = sin(1:8), cos = cos(1:8))
d$time <- c("Q1 1961", "Q2 1961", "Q3 1961", "Q4 1961", "Q1 1962",
"Q2 1962", "Q3 1962", "Q4 1962")
## convert to zoo series
library("zoo")
z <- zoo(as.matrix(d[, 1:2]), as.yearqtr(d$time, "Q%q %Y"))
## ggplot2 display
library("ggplot2")
autoplot(z)
## with nicer axis scaling
autoplot(z) + scale_x_yearqtr()
milk_df["Quarter"] <- apply(milk_df, MARGIN = 1, FUN = function(milk_df) paste(paste("Q", as.character(milk_df["Trimestre"]), sep = ""), as.character(milk_df["Ano"]), sep = " "))
source('~/Projects/kayaman/tsa/milk.R')
source('~/Projects/kayaman/tsa/milk.R')
autoplot(z)
## with nicer axis scaling
autoplot(z) + scale_x_yearqtr()
## some variations
autoplot(z, facets = Series ~ .) + scale_x_yearqtr() + geom_point()
autoplot(z, facets = NULL) + scale_x_yearqtr() + geom_point()
z
z <- zoo(as.matrix(milk_df$LeiteIndSP), as.yearqtr(milk_df$Date, "Q%q %Y"))
## ggplot2 display
library("ggplot2")
autoplot(z)
library(gdata)
library(zoo)
milk_df <- read.xls("/Users/kayaman/Projects/kayaman/tsa/Leite.xlsx", sheet = 3, header = TRUE)
milk_df["Quarter"] <- apply(milk_df, MARGIN = 1, FUN = function(milk_df) paste(paste("Q", as.character(milk_df["Trimestre"]), sep = ""), as.character(milk_df["Ano"]), sep = " "))
milk_train <- subset(milk_df, Ano < 2018)
milk_validation <- subset(milk_df, Ano == 2018)
z <- zoo(as.matrix(milk_df$LeiteIndSP), as.yearqtr(milk_df$Date, "Q%q %Y"))
z <- zoo(as.matrix(milk_df$LeiteIndSP), as.yearqtr(milk_df$Quarter, "Q%q %Y"))
## ggplot2 display
library("ggplot2")
autoplot(z)
## with nicer axis scaling
autoplot(z) + scale_x_yearqtr()
## some variations
autoplot(z, facets = Series ~ .) + scale_x_yearqtr() + geom_point()
autoplot(z, facets = NULL) + scale_x_yearqtr() + geom_point()
source('~/Projects/kayaman/tsa/milk.R')
## some variations
autoplot(z, facets = Series ~ .) + scale_x_yearqtr() + geom_point()
autoplot(z, facets = NULL) + scale_x_yearqtr() + geom_point()
## some variations
autoplot(z, facets = Series ~ .) + scale_x_yearqtr() + geom_point()
autoplot(z, facets = NULL) + scale_x_yearqtr() + geom_point()
source('~/Projects/kayaman/tsa/milk.R')
source('~/Projects/kayaman/tsa/milk.R')
help(ar)
ar.sim <- arima.sim(model = list(ar = c(.6), n = 1000))
ar.sim <- arima.sim(model = list(ar = c(.6)), n = 1000)
(ar.sim)
ts.plot(ar.sim)
ar.acf <- acf(ar.sim, type="correlation", plot=T)
source('~/Projects/kayaman/tsa/3b_sim_ar.R')
source('~/Projects/kayaman/tsa/3b_sim_ar.R')
help(ma)
help("arima.sim")
source('~/Projects/kayaman/tsa/3b_sim_ar.R')
ar.sim <- arima.sim(model = list(ar = c(.4), ma = c(1, -.3, -.8)), n = 1000)
ts.plot(ar.sim)
par(mfrow=c(2,1))
ar.acf <- acf(ar.sim, type = "correlation", plot = T)
ar.pacf <- acf(ar.sim, type = "partial", plot = T)
source('~/Projects/kayaman/tsa/3c_sim_ar.R')
source('~/Projects/kayaman/tsa/3c_sim_ar.R')
source('~/Projects/kayaman/tsa/3c_sim_ar.R')
source('~/Projects/kayaman/tsa/3b_sim_ar.R')
source('~/Projects/kayaman/tsa/3b_sim_ar.R')
source('~/Projects/kayaman/tsa/3b_sim_ar.R')
source('~/Projects/kayaman/tsa/3b_sim_ar.R')
Z_t <- arima.sim(model = list(ar = c(.3, -.585)), n = 1000)
par(mfrow=c(3,1))
ts.plot(Z_t)
ar.acf <- acf(Z_t, type = "correlation", plot = T)
ar.pacf <- acf(Z_t, type = "partial", plot = T)
source('~/Projects/kayaman/tsa/3b_sim_ar.R')
source('~/Projects/kayaman/tsa/MA.R')
source('~/Projects/kayaman/tsa/MA.R')
pacf(moving_average_process, main='Correlogram of a moving average process of order 2')
z <- zoo(as.matrix(milk_df$LeiteIndSP), as.yearqtr(milk_df$Quarter, "Q%q %Y"))
source('~/Projects/kayaman/tsa/milk.R')
library(gdata)
library(zoo)
library(ggplot2)
milk_df <- read.xls("/Users/kayaman/Projects/kayaman/tsa/Leite.xlsx", sheet = 3, header = TRUE)
milk_df["Quarter"] <- apply(milk_df, MARGIN = 1, FUN = function(milk_df) paste(paste("Q", as.character(milk_df["Trimestre"]), sep = ""), as.character(milk_df["Ano"]), sep = " "))
milk_train <- subset(milk_df, Ano < 2018)
milk_validation <- subset(milk_df, Ano == 2018)
z <- zoo(as.matrix(milk_df$LeiteIndSP), as.yearqtr(milk_df$Quarter, "Q%q %Y"))
autoplot(z, facets = NULL) + scale_x_yearqtr() + geom_point()
help(solve)
help(qs)
??qs
function(rootSolve)
\q
help(rootSolve)
getwd()
setwd("/Users/kayaman/Projects/kayaman/tsa/")
source('~/Projects/kayaman/_tsa_/3b_sim_ar.R')
source('~/Projects/kayaman/_tsa_/3b_sim_ar.R')
Z_t <- arima.sim(model = list(ar = c(.3, -.585)), n = 1000)
source('~/Projects/kayaman/_tsa_/3b_sim_ar.R')
source('~/Projects/kayaman/_tsa_/3b_sim_ar.R')
source('~/Projects/kayaman/_tsa_/3b_sim_ar.R')
source('~/Projects/kayaman/_tsa_/3c_sim_ar.R')
source('~/Projects/kayaman/tsa/3c_sim_ar.R')
source('~/Projects/kayaman/tsa/3b_sim_ar.R')
source('~/Projects/kayaman/tsa/3e_sim.R')
source('~/Projects/kayaman/tsa/3e_sim.R')
source('~/Projects/kayaman/_tsa_/milk.R')
source('~/Projects/kayaman/_tsa_/milk.R')
source('~/Projects/kayaman/_tsa_/milk.R')
source('~/Projects/kayaman/_tsa_/milk.R')
source('~/Projects/kayaman/_tsa_/milk.R')
library(ggplot2)
milk_df <- read.xls("/Users/kayaman/Projects/kayaman/tsa/MAE5870/lista1/Leite.xlsx", sheet = 3, header = TRUE)
milk_df["Quarter"] <- apply(milk_df, MARGIN = 1, FUN = function(milk_df) paste(paste("Q", as.character(milk_df["Trimestre"]), sep = ""), as.character(milk_df["Ano"]), sep = " "))
milk_train <- subset(milk_df, Ano < 2018)
milk_validation <- subset(milk_df, Ano == 2018)
z <- zoo(as.matrix(milk_df$LeiteIndSP), as.yearqtr(milk_df$Quarter, "Q%q %Y"))
autoplot(z, facets = NULL) + scale_x_yearqtr() + geom_point()
source('~/Projects/kayaman/tsa/MAE5870/lista1/3b_sim.R')
source('~/Projects/kayaman/tsa/MAE5870/lista1/3c_sim.R')
source('~/Projects/kayaman/tsa/MAE5870/lista1/3c_sim.R')
source('~/Projects/kayaman/tsa/MAE5870/lista1/3c_sim.R')
source('~/Projects/kayaman/tsa/MAE5870/lista1/3e_sim.R')
source('~/Projects/kayaman/_tsa_/milk.R')
autoplot(z, facets = NULL) + scale_x_yearqtr() + geom_point()
z <- zoo(as.matrix(milk_train$LeiteIndSP), as.yearqtr(milk_train$Quarter, "Q%q %Y"))
plot(z, ylab = "Leite", main = "Leite SP")
source('~/Projects/kayaman/_tsa_/milk.R')
plot(milk.ts, ylab = "Leite", main = "Leite SP")
milk.MA = filter(milk.ts, rep(1/3, 3), sides = 2)
lines(milk.MA, col = "red")
milk.MA = filter(milk.ts, rep(1/5, 5), sides = 2)
lines(milk.MA, col = "red")
source('~/Projects/kayaman/_tsa_/milk.R')
par(mfrow=c(3,1))
Y = milk.ts / milk.MA
plot( Y, ylab="scaled", main="Transformed Milk Data")
acf(na.omit(Y), main="ACF of Transformed Data")
acf(na.omit(Y), type="partial", main="PACF of Transformed Data")
ar(na.omit(Y), order.max = 5)
Z <- milk_train$LeiteIndSP
Z <- milk_train$LeiteIndSP
for (t in 77:80) {
Z[t] <- -.4070*Z[t-1] -.3439*Z[t-2] - .1779*Z[t-3]
}
plot(Z)
for (t in 77:80) {
print(milk_df$LeiteIndSP[t])
print(Z[t])
}
source('~/Projects/kayaman/tsa/MAE5870/lista1/Ex_Luis.R')
source('~/Projects/kayaman/_tsa_/milk.R')
source('~/Projects/kayaman/tsa/MAE5870/lista1/3e.R')
source('~/Projects/kayaman/tsa/MAE5870/lista1/3e.R')
source('~/Projects/kayaman/tsa/MAE5870/lista1/3e.R')
source('~/Projects/kayaman/tsa/MAE5870/lista1/3e.R')
help(polyroot)
polyroot(c(-.8, .5))
Mod(polyroot(c(-.8, .5)))
source('~/Projects/kayaman/tsa/MAE5870/lista1/3c.R')
source('~/Projects/kayaman/tsa/MAE5870/lista1/3c.R')
source('~/Projects/kayaman/tsa/MAE5870/lista1/3c.R')
source('~/Projects/kayaman/tsa/MAE5870/lista1/3c.R')
source('~/Projects/kayaman/tsa/MAE5870/lista1/3c.R')
source('~/Projects/kayaman/tsa/MAE5870/lista1/Ex_Luis.R')
source('~/Projects/kayaman/tsa/MAE5870/lista1/3c.R')
source('~/Projects/kayaman/tsa/MAE5870/lista1/3c.R')
source('~/Projects/kayaman/tsa/MAE5870/lista1/3e.R')
source('~/Projects/kayaman/tsa/MAE5870/lista1/3e.R')
source('~/Projects/kayaman/tsa/MAE5870/lista1/3e.R')
source('~/Projects/kayaman/tsa/MAE5870/lista1/3e.R')
help("plot")
help(plot)
source('~/Projects/kayaman/tsa/MAE5870/lista1/3e.R')
source('~/Projects/kayaman/tsa/MAE5870/lista1/3e.R')
source('~/Projects/kayaman/tsa/MAE5870/lista1/3e.R')
source('~/Projects/kayaman/tsa/MAE5870/lista1/3e.R')
source('~/Projects/kayaman/tsa/MAE5870/lista1/3e.R')
source('~/Projects/kayaman/tsa/MAE5870/lista1/3e.R')
source('~/Projects/kayaman/tsa/MAE5870/lista1/3e.R')
source('~/Projects/kayaman/tsa/MAE5870/lista1/3e.R')
source('~/Projects/kayaman/tsa/MAE5870/lista1/3c.R')
source('~/Projects/kayaman/tsa/MAE5870/lista1/3c.R')
milk_df <- read.csv("~/Projects/kayaman/tsa/MAE5870/lista1/milk/milk.csv", header = TRUE)
milk_df$Quarter <- apply(milk_df$Quarter, as.yearqtr)
milk_df$Quarter <- apply(milk_df$Quarter, as.yearqtr())
milk_df$Quarter <- apply(milk_df$Quarter, as.yearqtr(milk_df$Quarter))
milk_df$Quarter <- apply(milk_df, FUN = as.yearqtr(milk_df$Quarter))
milk_df$Quarter <- apply(milk_df, MARGIN = c("Quarter"), FUN = yearqtr())
milk_df$Quarter <- apply(milk_df, MARGIN = c("Quarter"), FUN = yearqtr)
apply(milk_df, MARGIN = c("Quarter"), FUN = yearqtr)
dimnames(milk_df) <- c("Quarter", "Production")
dimnames(milk_df) <- c("Quarter", "Quantity")
apply(milk_df, MARGIN = 1, FUN = yearqtr)
milk_df$Quarter <- as.yearqtr(milk_df$Quarter, "Q%q %Y")
plot.ts(milk.ts)
milk.ts <- ts(milk_df)
plot.ts(milk.ts)
library(ggplot2)
library(ggplot2)
milk.ts <- zoo(milk_df)
plot.ts(milk.ts)
autoplot(milk.ts, facets = NULL) + scale_x_yearqtr() + geom_point()
source('~/Projects/kayaman/tsa/MAE5870/lista1/milk/milk.R')
autoplot(milk.ts, facets = NULL) + scale_x_yearqtr() + geom_point()
source('~/Projects/kayaman/tsa/MAE5870/lista1/milk/milk.R')
source('~/Projects/kayaman/tsa/MAE5870/lista1/milk/milk.R')
plot(milk.ts, ylab = "Quadrimestre", main = "Produção Leite SP", ylim = 1000000)
milk.ts <- zoo(as.matrix(milk_df$Quarter, milk_df$Quantity))
#autoplot(milk.ts, facets = NULL) + scale_x_yearqtr() + geom_point()
par(mfrow=c(3,1))
plot(milk.ts, ylab = "Quadrimestre", main = "Produção Leite SP", ylim = 1000000)
milk.MA = filter(milk.ts, rep(1/5, 5), sides = 2)
lines(milk.MA, col = "red")
source('~/Projects/kayaman/tsa/MAE5870/lista1/milk/milk.R')
source('~/Projects/kayaman/tsa/MAE5870/lista1/milk/milk.R')
source('~/Projects/kayaman/tsa/MAE5870/lista1/milk/milk.R')
source('~/Projects/kayaman/tsa/MAE5870/lista1/milk/milk.R')
source('~/Projects/kayaman/tsa/MAE5870/lista1/milk/milk.R')
source('~/Projects/kayaman/tsa/MAE5870/lista1/milk/milk.R')
source('~/Projects/kayaman/tsa/MAE5870/lista1/milk/milk.R')
milk_df <- read.csv("~/Projects/kayaman/tsa/MAE5870/lista1/milk/milk.csv", header = TRUE)
source('~/Projects/kayaman/tsa/MAE5870/lista1/milk/milk.R')
plot.ts(milk.ts, ylab = "Quadrimestre", main = "Produção Leite SP")
milk.MA = filter(milk.ts, rep(1/5, 5), sides = 2)
lines(milk.MA, col = "red")
source('~/Projects/kayaman/tsa/MAE5870/lista1/milk/milk.R')
ar(na.omit(Y), order.max = 5)
arima(na.omit(Y), order.max = 5)
arma(na.omit(Y), order.max = 5)
ar(na.omit(Y), order.max = 5)
ar(na.omit(Y), order.max = 15)
polyroot(c(-.0263,-.7327))
source('~/Projects/kayaman/tsa/MAE5870/lista1/3c.R')
source('~/Projects/kayaman/tsa/MAE5870/lista1/milk/milk.R')
